<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MS2760A &mdash; Instruments Automatisation Libraries 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Instruments Automatisation Libraries
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Instruments Automatisation Libraries</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">MS2760A</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MS2760A</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Wed Dec  1 13:11:32 2021</span>

<span class="sd">@author: Martin.Mihaylov</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyvisa</span> <span class="k">as</span> <span class="nn">visa</span>


    
<div class="viewcode-block" id="MS2760A">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A">[docs]</a>
<span class="k">class</span> <span class="nc">MS2760A</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_str</span><span class="p">):</span>

        <span class="c1"># self._resource = visa.ResourceManager().open_resource(&#39;TCPIP::&#39; + str(resource_str) + &#39;::9001::SOCKET&#39;,read_termination = &#39;\n&#39;,query_delay  = 0.5)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resource</span> <span class="o">=</span> <span class="n">visa</span><span class="o">.</span><span class="n">ResourceManager</span><span class="p">()</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">resource_str</span><span class="p">),</span><span class="n">read_termination</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">query_delay</span>  <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resource</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;*IDN?&#39;</span><span class="p">))</span>

        
<div class="viewcode-block" id="MS2760A.query">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.query">[docs]</a>
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resource</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="MS2760A.write">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.write">[docs]</a>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resource</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="MS2760A.Close">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.Close">[docs]</a>
    <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resource</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    

<span class="c1"># =============================================================================</span>
<span class="c1"># Abort</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="MS2760A.abort">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.abort">[docs]</a>
    <span class="k">def</span> <span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Description: Resets the trigger system. This has the effect of aborting the sweep or any measurement</span>
<span class="sd">        that is currently in progress.</span>
<span class="sd">        Additionally, any pending operation flags that were set by initiation of the trigger system</span>
<span class="sd">        will be set to false.</span>
<span class="sd">        If :INITiate:CONTinuous is OFF (i.e. the instrument is in single sweep mode), send the</span>
<span class="sd">        command :INITiate[:IMMediate] to trigger the next sweep.</span>
<span class="sd">        If :INITiate:CONTinuous is ON (i.e. the instrument is in continuous sweep mode) a new</span>
<span class="sd">        sweep will start immediately</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:ABORt&#39;</span><span class="p">)</span></div>

        
    
    
<span class="c1"># =============================================================================</span>
<span class="c1"># Start Measurment</span>
<span class="c1"># =============================================================================</span>
 
<div class="viewcode-block" id="MS2760A.Init">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.Init">[docs]</a>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>
<span class="sd">            Initialize meas</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:INITiate:IMMediate&#39;</span><span class="p">)</span></div>

    
    
<span class="c1"># =============================================================================</span>
<span class="c1"># OPC</span>
<span class="c1"># =============================================================================</span>
    
<div class="viewcode-block" id="MS2760A.OPC">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.OPC">[docs]</a>
    <span class="k">def</span> <span class="nf">OPC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Places a “1” into the output queue when all device</span>
<span class="sd">            operations have been completed</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;*OPC?&#39;</span><span class="p">)</span></div>

    


<span class="c1"># =============================================================================</span>
<span class="c1"># Ask Frequency</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="MS2760A.ask_freq_Start">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_freq_Start">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_freq_Start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Query return set start Frequency.</span>
<span class="sd">            Numeric (Hz)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:STARt?&#39;</span><span class="p">)</span></div>

        
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_freq_Stop">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_freq_Stop">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_freq_Stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str </span>
<span class="sd">            Query return set stop Frequency.</span>
<span class="sd">            Numeric (Hz)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:STOP?&#39;</span><span class="p">)</span></div>


    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_ResBwidth">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_ResBwidth">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_ResBwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Ask the resolution bandwidth.</span>
<span class="sd">            Query Return: Numeric (Hz)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:BANDwidth:RESolution?&#39;</span><span class="p">))</span></div>

    
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_SingleOrContinuesMeas">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_SingleOrContinuesMeas">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_SingleOrContinuesMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        data : str</span>
<span class="sd">            The query version of the command returns a 1 if the instrument is</span>
<span class="sd">            continuously sweeping/measuring and returns a 0 if the instrument is in single</span>
<span class="sd">            sweep/measurement mode.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:INITiate:CONTinuous?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;The instrument is continuously sweeping/measuring mode!&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;The instrument is in single sweep/measurement mode!&#39;</span>
        <span class="k">return</span> <span class="n">data</span></div>

    
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_Configuration">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_Configuration">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_Configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Title: Option Configuration</span>
<span class="sd">            Description: This command returns a quoted string of characters readable only by Anritsu Customer</span>
<span class="sd">            Service. Only instrument configuration information is returned. No setup information is</span>
<span class="sd">            included.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SYSTem:OPTions:CONFig?&#39;</span><span class="p">)</span></div>

    
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_sweepTime">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_sweepTime">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_sweepTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Title: Measured Sweep Time</span>
<span class="sd">            Description: This command queries the measured sweep time, in number of milliseconds. This</span>
<span class="sd">            command will return &quot;nan&quot; if no measured sweep time is available, which happens if the</span>
<span class="sd">            sweep was reset and the instrument has not yet swept enough to measure a full sweep.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:DIAGnostic:SWEep:TIME?&#39;</span><span class="p">)</span></div>

    
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_TraceData">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_TraceData">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_TraceData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">traceNumber</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        !!!!!DONT USE IT!!!!! </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        traceNumber : int</span>
<span class="sd">            Description: This command transfers trace data from the instrument to the controller. Data are</span>
<span class="sd">            transferred from the instrument as an IEEE definite length arbitrary block response,</span>
<span class="sd">            which has the form &lt;header&gt;&lt;block&gt;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">           Trace Data</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">traceNumber</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">traceNumber</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:TRACe:DATA? &#39;</span> <span class="o">+</span> <span class="n">traceNumber</span><span class="p">)</span></div>

        
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_ResBwidthAuto">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_ResBwidthAuto">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_ResBwidthAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        val : str</span>
<span class="sd">            Query the resolution bandwidth.</span>
<span class="sd">            Defaoulf: ON</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:BANDwidth:RESolution:AUTO?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s1">&#39;OFF&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s1">&#39;ON&#39;</span>
        <span class="k">return</span> <span class="n">val</span></div>

    
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_DataPointCount">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_DataPointCount">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_DataPointCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Query the data point count.</span>
<span class="sd">            Title: Display Point Count</span>
<span class="sd">            Query Return: Numeric</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:DISPlay:POINtcount?&#39;</span><span class="p">)</span></div>

    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_MarkerExcursionState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_MarkerExcursionState">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_MarkerExcursionState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Turn on/off excursion checking for marker max commands</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:PEAK:EXCursion:STATe?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;OFF&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;ON&#39;</span></div>

        
        
        
        
    
<div class="viewcode-block" id="MS2760A.ask_MarkerExcursion">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_MarkerExcursion">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_MarkerExcursion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Query the excursion for a marker. The excursion is the vertical distance from the peak to</span>
<span class="sd">            the next highest valley which must be exceeded for a peak to be considered a peak in</span>
<span class="sd">            marker max commands</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:DATA:ALL?&#39;</span><span class="p">)</span></div>

        
    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_CHPowerState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_CHPowerState">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_CHPowerState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : str/int</span>
<span class="sd">        </span>
<span class="sd">            Channel Power State</span>
<span class="sd">            Sets the state of the channel power measurement, ON or OFF. When using</span>
<span class="sd">            :CONFigure:CHPower,the state is automatically set to ON</span>
<span class="sd">            state = [&#39;ON&#39;,&#39;OFF&#39;,1,0]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            State ON or OFF</span>

<span class="sd">        &#39;&#39;&#39;</span>
       
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:CHPower:STATe?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;OFF&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;ON&#39;</span></div>

        
        
        
        
<div class="viewcode-block" id="MS2760A.ask_DataFormat">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_DataFormat">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_DataFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">             Query the data format</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FORMat:TRACe:DATA?&#39;</span><span class="p">)</span></div>

    
    
    
    
<div class="viewcode-block" id="MS2760A.ask_CenterFreq">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_CenterFreq">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_CenterFreq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE float</span>
<span class="sd">            Query the Central Frequency</span>
<span class="sd">            Numeric (Hz)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:CENTer?&#39;</span><span class="p">))</span></div>

    
    
    

<div class="viewcode-block" id="MS2760A.ask_TraceType">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_TraceType">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_TraceType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        number : int</span>
<span class="sd">            Specifies how successive sweeps are combined to produce the resulting display value.</span>
<span class="sd">            Setting the TYPE to NORMal will cause the displayed value for a point to be the current</span>
<span class="sd">            measured value for that point. Setting the TYPE to AVERage will cause the displayed</span>
<span class="sd">            value for a point to be the average of the last &lt;integer&gt; measured values where &lt;integer&gt;</span>
<span class="sd">            is set by [:SENSe]:AVERage:COUNt. Setting the TYPE to MAXimum will cause the</span>
<span class="sd">            displayed value for a point is the maximum measured value for that point over sweeps.</span>
<span class="sd">            Setting the TYPE to MINimum will cause the displayed value for a point is the minimum</span>
<span class="sd">            measured value for that point over sweeps.Setting the TYPE to RMAXimum will cause</span>
<span class="sd">            the displayed value for a point to be the maximum of the last &lt;integer&gt; measured values</span>
<span class="sd">            where &lt;integer&gt; is set by [:SENSe]:AVERage:COUNt.Setting the TYPE to RMINimum</span>
<span class="sd">            will cause the displayed value for a point to be the minimum of the last &lt;integer&gt;</span>
<span class="sd">            measured values where &lt;integer&gt; is set by [:SENSe]:AVERage:COUNt. This command</span>
<span class="sd">            will be ignored when spectrogram is disabled by DISPlay:VIEW.</span>
<span class="sd">            </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Query Return: NORM|MIN|MAX|AVER|RMAX|RMIN|RAV</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">stNumber</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:TRACe&#39;</span> <span class="o">+</span> <span class="n">number</span><span class="o">+</span><span class="s1">&#39;:TYPE?&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span> </div>

            
            
            
            
            
<div class="viewcode-block" id="MS2760A.ask_TraceSelected">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_TraceSelected">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_TraceSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE str</span>
<span class="sd">            Query selected trace will be used by operations that use a single trace. The max number of</span>
<span class="sd">            traces available to select is model specific</span>

<span class="sd">        &#39;&#39;&#39;</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The selected trace will be used by operations that use a single trace. The max number of</span>
<span class="sd">        traces available to select is model specific</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:TRACe:SELect?&#39;</span><span class="p">)</span></div>

    
    
    
<div class="viewcode-block" id="MS2760A.ask_TraceState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ask_TraceState">[docs]</a>
    <span class="k">def</span> <span class="nf">ask_TraceState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        number : int</span>
<span class="sd">                 Description: The trace visibility state. If it is OFF, the :TRAC:DATA? command will return nan.</span>
<span class="sd">                Trace Number:</span>
<span class="sd">                    int. [1,2,3,4,5,6]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            State ON or OFF</span>

<span class="sd">        &#39;&#39;&#39;</span>
       
        <span class="n">stNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">stNumber</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:TRACe&#39;</span><span class="o">+</span><span class="n">number</span><span class="o">+</span><span class="s1">&#39;:DISPlay:STATe?&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Trace is OFF&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Trace is ON&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span> </div>

            
        
        
        
        
        
    
    
<span class="c1"># =============================================================================</span>
<span class="c1"># Get Data</span>
<span class="c1"># =============================================================================</span>
   

        
    
    
<span class="c1"># =============================================================================</span>
<span class="c1">#  Test param from MatLab Scripts</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="MS2760A.set_DataPointCount">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_DataPointCount">[docs]</a>
    <span class="k">def</span> <span class="nf">set_DataPointCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">                Title: Display Point Count</span>
<span class="sd">                Description: Changes the number of display points the instrument currently measures. Increasing the</span>
<span class="sd">                number of display points can improve the resolution of measurements but will also</span>
<span class="sd">                increase sweep time.</span>
<span class="sd">                </span>
<span class="sd">               Default Value: 501</span>
<span class="sd">               Range: 10 to 10001</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;=</span><span class="mi">10</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">&gt;=</span> <span class="mi">10001</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:DISPlay:POINtcount &#39;</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span> </div>

            
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_freq_Start">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_freq_Start">[docs]</a>
    <span class="k">def</span> <span class="nf">set_freq_Start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int/float</span>
<span class="sd">            Description: Sets the start frequency. Note that in the spectrum analyzer, changing the value of the</span>
<span class="sd">            start frequency will change the value of the coupled parameters, Center Frequency and</span>
<span class="sd">            Span.</span>
<span class="sd">                </span>
<span class="sd">        unit : str</span>
<span class="sd">            Parameters: &lt;numeric_value&gt; {HZ | KHZ | MHZ | GHZ}</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stUnit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HZ&#39;</span><span class="p">,</span><span class="s1">&#39;KHZ&#39;</span><span class="p">,</span><span class="s1">&#39;MHZ&#39;</span><span class="p">,</span><span class="s1">&#39;GHZ&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">stUnit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:STARt &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>


    
    
    
    
<div class="viewcode-block" id="MS2760A.set_freq_Stop">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_freq_Stop">[docs]</a>
    <span class="k">def</span> <span class="nf">set_freq_Stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int/float</span>
<span class="sd">                Description: Sets the start frequency. Note that in the spectrum analyzer, changing the value of the</span>
<span class="sd">                start frequency will change the value of the coupled parameters, Center Frequency and</span>
<span class="sd">                Span.</span>
<span class="sd">            </span>
<span class="sd">        unit : str</span>
<span class="sd">            Parameters: &lt;numeric_value&gt; {HZ | KHZ | MHZ | GHZ}</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stUnit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HZ&#39;</span><span class="p">,</span><span class="s1">&#39;KHZ&#39;</span><span class="p">,</span><span class="s1">&#39;MHZ&#39;</span><span class="p">,</span><span class="s1">&#39;GHZ&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">stUnit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:STOP &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span>   </div>

            
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_ResBwidth">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_ResBwidth">[docs]</a>
    <span class="k">def</span> <span class="nf">set_ResBwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int/float</span>
<span class="sd">            Description: Sets the resolution bandwidth.</span>
<span class="sd">            Note that using this command turns the automatic resolution bandwidth setting OFF.</span>
<span class="sd">            In Zero Span, the range will change to allow a mininum of 5 KHz to the maximum of 20</span>
<span class="sd">            MHz.</span>
<span class="sd">        unit : str</span>
<span class="sd">            Parameters: &lt;numeric_value&gt; {HZ | KHZ | MHZ | GHZ}</span>
<span class="sd">            Default Unit: Hz</span>
<span class="sd">                </span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stUnit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HZ&#39;</span><span class="p">,</span><span class="s1">&#39;KHZ&#39;</span><span class="p">,</span><span class="s1">&#39;MHZ&#39;</span><span class="p">,</span><span class="s1">&#39;GHZ&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">stUnit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:BANDwidth:RESolution &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span> </div>

            
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_ResBwidthAuto">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_ResBwidthAuto">[docs]</a>
    <span class="k">def</span> <span class="nf">set_ResBwidthAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : int/str</span>
<span class="sd">            Title:RBW AutoDescription:Sets the state of the coupling of the resolution bandwidth </span>
<span class="sd">            to the frequency span. Setting the value to ON or 1 will result in the resolution</span>
<span class="sd">            bandwidth being coupled to the span. That is, when the span changes, the </span>
<span class="sd">            resolution bandwidth changes. Setting the value to OFF or 0 will result in the </span>
<span class="sd">            resolution bandwidth being decoupled from the span. That is, changing the span </span>
<span class="sd">            will not change the resolution bandwidth. When this command is issued, the resolution </span>
<span class="sd">            bandwidth setting itself will not change.</span>
<span class="sd">            Parameters:&lt;1 | 0 | ON | OFF&gt;</span>
<span class="sd">            Default Value:ON</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">             Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span><span class="s1">&#39;OFF&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stList</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:BANDwidth:RESolution:AUTO &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

        
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_CenterFreq">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_CenterFreq">[docs]</a>
    <span class="k">def</span> <span class="nf">set_CenterFreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float </span>
<span class="sd">            Sets the center frequency. Note that changing the value of the center frequency will</span>
<span class="sd">            change the value of the coupled parameters Start Frequency and Stop Frequency. It</span>
<span class="sd">            might also change the value of the span.</span>
<span class="sd">            </span>
<span class="sd">        unit : str</span>
<span class="sd">            Unit value. Can be [&#39;HZ&#39;,&#39;KHZ&#39;,&#39;MHZ&#39;,&#39;GHZ&#39;]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">sUnits</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HZ&#39;</span><span class="p">,</span><span class="s1">&#39;KHZ&#39;</span><span class="p">,</span><span class="s1">&#39;MHZ&#39;</span><span class="p">,</span><span class="s1">&#39;GHZ&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">sUnits</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:FREQuency:CENTer &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

    
    
    
    
<div class="viewcode-block" id="MS2760A.set_ContinuousMeas">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_ContinuousMeas">[docs]</a>
    <span class="k">def</span> <span class="nf">set_ContinuousMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : str/int</span>
<span class="sd">            Title: Sweep Type</span>
<span class="sd">            Description: Specifies whether the sweep/measurement is triggered continuously. If the value is set to</span>
<span class="sd">            ON or 1, another sweep/measurement is triggered as soon as the current one completes.</span>
<span class="sd">            If continuous is set to OFF or 0, the instrument remains initiated until the current</span>
<span class="sd">            sweep/measurement completes, then enters the &#39;idle&#39; state and waits for the</span>
<span class="sd">            :INITiate[:IMMediate] command or for :INITiate:CONTinuous ON.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">             Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span><span class="s1">&#39;OFF&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stList</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:INITiate:CONTinuous &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

        
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_DataFormat">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_DataFormat">[docs]</a>
    <span class="k">def</span> <span class="nf">set_DataFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">status</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        status : str</span>
<span class="sd">            Set Data Format status =  [&#39;ASCii&#39;,&#39;INTeger&#39;,&#39;REAL&#39;]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">statusLs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ASCii&#39;</span><span class="p">,</span><span class="s1">&#39;INTeger&#39;</span><span class="p">,</span><span class="s1">&#39;REAL&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">statusLs</span><span class="p">:</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:FORMat:TRACe:DATA &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

            



    
<div class="viewcode-block" id="MS2760A.set_Continuous">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_Continuous">[docs]</a>
    <span class="k">def</span> <span class="nf">set_Continuous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">status</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        status : str/int</span>
<span class="sd">            Stop/start Sweep. Can be [&#39;ON&#39;, &#39;OFF&#39;, 1, 0]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">satusLs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span> <span class="s1">&#39;OFF&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">satusLs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;INIT:CONT &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

        
        
        
        
        
<div class="viewcode-block" id="MS2760A.set_MarkerExcursionState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_MarkerExcursionState">[docs]</a>
    <span class="k">def</span> <span class="nf">set_MarkerExcursionState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : str/int</span>
<span class="sd">            Turn on/off excursion checking for marker max commands.</span>
<span class="sd">            Can be state = [&#39;ON&#39;,&#39;OFF&#39;,1,0]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span><span class="s1">&#39;OFF&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:PEAK:EXCursion:STATe &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

            
            
            
            
<div class="viewcode-block" id="MS2760A.set_MarkerExcursion">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_MarkerExcursion">[docs]</a>
    <span class="k">def</span> <span class="nf">set_MarkerExcursion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            Sets the excursion for a marker. The excursion is the vertical distance from the peak to</span>
<span class="sd">            the next highest valley which must be exceeded for a peak to be considered a peak in</span>
<span class="sd">            marker max commands</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:PEAK:EXCursion &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; DB&#39;</span><span class="p">)</span></div>

        
        
        
        
        
<div class="viewcode-block" id="MS2760A.set_NextPeak">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_NextPeak">[docs]</a>
    <span class="k">def</span> <span class="nf">set_NextPeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>
<span class="sd">            Moves the marker X value to the point in the marker&#39;s assigned </span>
<span class="sd">            trace that is the next highest peak</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:MAXimum:NEXT&#39;</span><span class="p">)</span></div>

        
        
        
        
        
<div class="viewcode-block" id="MS2760A.set_MaxPeak">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_MaxPeak">[docs]</a>
    <span class="k">def</span> <span class="nf">set_MaxPeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>
<span class="sd">            Moves the marker X value to the point in the marker&#39;s assigned </span>
<span class="sd">            trace that has the highest peak.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:MAXimum&#39;</span><span class="p">)</span></div>

        
        
        
        
        
<div class="viewcode-block" id="MS2760A.set_MarkerPreset">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_MarkerPreset">[docs]</a>
    <span class="k">def</span> <span class="nf">set_MarkerPreset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>
<span class="sd">            Presets all markers to their preset values.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:CALCulate:MARKer:APReset&#39;</span><span class="p">)</span></div>

        
        
        
        
<div class="viewcode-block" id="MS2760A.set_CHPowerState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_CHPowerState">[docs]</a>
    <span class="k">def</span> <span class="nf">set_CHPowerState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state :str</span>
<span class="sd">            Sets the state of the channel power measurement, ON or OFF. When using</span>
<span class="sd">            :CONFigure:CHPower,the state is automatically set to ON</span>
<span class="sd">            state = [&#39;ON&#39;,&#39;OFF&#39;,1,0]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span><span class="s1">&#39;OFF&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stList</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:SENSe:CHPower:STATe &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

        
        
        
        
        
<div class="viewcode-block" id="MS2760A.set_TraceType">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_TraceType">[docs]</a>
    <span class="k">def</span> <span class="nf">set_TraceType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : str</span>
<span class="sd">             Sets Trace Type:</span>
<span class="sd">                            Normal - NORM</span>
<span class="sd">                            Hold the Minimmum - MIN</span>
<span class="sd">                            Hold the Maximum - MAX</span>
<span class="sd">                            Average - AVER</span>
<span class="sd">                            Rolling Max Hold - RMAX</span>
<span class="sd">                            Rolling Min Hold - RMIN</span>
<span class="sd">                            Rolling Avarage - RAV</span>
<span class="sd">        number : int</span>
<span class="sd">            Trace number:</span>
<span class="sd">                        Can be set to [1,2,3,4,5,6]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;AVER&#39;</span><span class="p">,</span> <span class="s1">&#39;RMAX&#39;</span><span class="p">,</span> <span class="s1">&#39;RMIN&#39;</span><span class="p">,</span> <span class="s1">&#39;RAV&#39;</span><span class="p">]</span>
        <span class="n">stNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stList</span> <span class="ow">and</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">stNumber</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:TRACe&#39;</span><span class="o">+</span><span class="n">number</span><span class="o">+</span><span class="s1">&#39;:TYPE &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

            
    
    
    
    
    
<div class="viewcode-block" id="MS2760A.set_TraceSelected">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_TraceSelected">[docs]</a>
    <span class="k">def</span> <span class="nf">set_TraceSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        number : int</span>
<span class="sd">            The selected trace will be used by operations that use a single trace. The max number of</span>
<span class="sd">            traces available to select is model specific.</span>
<span class="sd">            Trace number:</span>
<span class="sd">                        Can be set to [1,2,3,4,5,6]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">stNumber</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:TRACe:SELect &#39;</span><span class="o">+</span><span class="n">number</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span></div>

            
            
            
            
            
<div class="viewcode-block" id="MS2760A.set_TraceState">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.set_TraceState">[docs]</a>
    <span class="k">def</span> <span class="nf">set_TraceState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : str</span>
<span class="sd">            The trace visibility state status. If it is OFF, the :TRAC:DATA? </span>
<span class="sd">            command will return NaN.</span>
<span class="sd">            [&#39;ON&#39;,&#39;OFF&#39;,0,1]</span>
<span class="sd">        number : int</span>
<span class="sd">            Trace Number:</span>
<span class="sd">                Can be set to  [1,2,3,4,5,6]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">             Error message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">stNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">stList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span><span class="s1">&#39;OFF&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">stNumber</span> <span class="ow">and</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stList</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:TRACe&#39;</span><span class="o">+</span><span class="n">number</span><span class="o">+</span><span class="s1">&#39;:DISPlay:STATe &#39;</span><span class="o">+</span><span class="n">state</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown input! See function description for more info.&#39;</span><span class="p">)</span> </div>

            
            
            
            
<span class="c1"># =============================================================================</span>
<span class="c1">#   get/Save Data   </span>
<span class="c1"># =============================================================================</span>



<div class="viewcode-block" id="MS2760A.get_Data">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.get_Data">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        This function will stop temporally set Continuous Measurment to OFF, extract </span>
<span class="sd">        the max.peak value and frequency and restore the Continuous Measurment to ON.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OutPut : dict</span>
<span class="sd">            Return a dictionary whit the measured voltage and current.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">OutPut</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ContinuousMeas</span><span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_MarkerPreset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_MaxPeak</span><span class="p">()</span>
        <span class="n">Power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask_MarkerExcursion</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Freq</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask_MarkerExcursion</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_MarkerPreset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ContinuousMeas</span><span class="p">(</span><span class="s1">&#39;ON&#39;</span><span class="p">)</span>
        <span class="n">OutPut</span><span class="p">[</span><span class="s1">&#39;Power/dBm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Power</span>
        <span class="n">OutPut</span><span class="p">[</span><span class="s1">&#39;Frequency/Hz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Freq</span>
        <span class="k">return</span> <span class="n">OutPut</span></div>

        
    
    
    
<div class="viewcode-block" id="MS2760A.ExtractTtraceData">
<a class="viewcode-back" href="../rst/MS2760A.html#MS2760A.MS2760A.ExtractTtraceData">[docs]</a>
    <span class="k">def</span> <span class="nf">ExtractTtraceData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">        </span>
<span class="sd">        !!!!!USE IT AT YOUR OWN RISK is not an official function, but a workaround!!!!! </span>
<span class="sd">        </span>
<span class="sd">            Trace Number from which the data is taken:</span>
<span class="sd">                Can be set to  [1,2,3,4,5,6].</span>
<span class="sd">            1 - This Function will set the continues measurment to &#39;OFF&#39;.</span>
<span class="sd">            2 - Will set the Data Format to ASCii. This is needed since</span>
<span class="sd">            :TREACE:DATA? &lt;num&gt; is defect!! </span>
<span class="sd">            3 - Will write TRACE:DATA? &lt;num&gt;. Will return only 3 bits. The rest</span>
<span class="sd">            will be packed in the next command asked.</span>
<span class="sd">            4 - Will ask for the Data Format. This is dummy command that will </span>
<span class="sd">            have the data and the Data Format.</span>
<span class="sd">            5 - Make manupulations to separate the actual data from the rest and</span>
<span class="sd">            return the data in Output np.array() form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Output : TYPE</span>
<span class="sd">            DESCRIPTION.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">set_Continuous</span><span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_DataFormat</span><span class="p">(</span><span class="s1">&#39;ASCii&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;:TRACe:DATA? &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask_DataFormat</span><span class="p">()</span>
        <span class="n">new_str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">data_arr</span> <span class="o">=</span> <span class="n">new_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">Output</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_arr</span><span class="p">]</span>
        <span class="n">Output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_Continuous</span><span class="p">(</span><span class="s1">&#39;ON&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Output</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Martin.Mihaylov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>